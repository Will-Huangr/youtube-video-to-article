# ğŸ¬ YouTube å­—å¹•æå–é—®é¢˜è§£å†³æ–¹æ¡ˆ

## ğŸš« é—®é¢˜æè¿°
ä½¿ç”¨ `youtube_transcript_api` æ—¶é‡åˆ°ä»¥ä¸‹é”™è¯¯ï¼š
```
Could not retrieve a transcript for the video! This is most likely caused by:
YouTube is blocking requests from your IP.
```

## âœ… è§£å†³æ–¹æ¡ˆï¼šyt-dlp åŒé‡ä¿éšœ

æœ¬é¡¹ç›®ç°åœ¨æ”¯æŒ**åŒé‡å­—å¹•æå–æœºåˆ¶**ï¼š
1. **ä¸»æ–¹æ¡ˆ**: `youtube_transcript_api` 
2. **å¤‡é€‰æ–¹æ¡ˆ**: `yt-dlp` (å½“ä¸»æ–¹æ¡ˆå¤±è´¥æ—¶è‡ªåŠ¨åˆ‡æ¢)

## ğŸ› ï¸ å®‰è£…å’Œæ›´æ–°

### æ–¹æ³•1: ä½¿ç”¨æ›´æ–°è„šæœ¬ (æ¨è)
```bash
# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate

# è¿è¡Œæ›´æ–°è„šæœ¬
python update_ytdlp.py
```

### æ–¹æ³•2: æ‰‹åŠ¨å®‰è£…
```bash
# ç¨³å®šç‰ˆ
pip install -U yt-dlp

# å¤œé—´ç‰ˆ (ä¿®å¤æœ€æ–°å°é”)
pip install -U --pre yt-dlp

# ä¸»åˆ†æ”¯ç‰ˆ (æœ€æ–°åŠŸèƒ½)
pip install -U git+https://github.com/yt-dlp/yt-dlp.git
```

## ğŸ”„ ä¸‰ç§æ›´æ–°é€šé“

| é€šé“ | æ›´æ–°é¢‘ç‡ | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|-----|---------|------|---------|
| **stable** | æ•°æœˆä¸€æ¬¡ | åŠŸèƒ½ç¨³å®š | æ™®é€šç”¨æˆ· |
| **nightly** | æ¯æ—¥æ›´æ–° | ä¿®å¤æœ€æ–°å°é” | **æ¨èä½¿ç”¨** |
| **master** | å®æ—¶æ›´æ–° | æœ€æ–°åŠŸèƒ½ï¼Œå¯èƒ½æœ‰Bug | é«˜çº§ç”¨æˆ· |

## ğŸ¯ ä½¿ç”¨æ–¹æ³•

### 1. å¯åŠ¨åº”ç”¨
```bash
cd volcengine-visual-api
source venv/bin/activate
python run.py
```

### 2. æµ‹è¯•å­—å¹•æå–
è®¿é—® http://127.0.0.1:8080 ç„¶åï¼š

- **YouTube å¯ç”¨æ—¶**: ç›´æ¥è¾“å…¥è§†é¢‘é“¾æ¥
- **YouTube è¢«å°æ—¶**: ç‚¹å‡» "ğŸ¤– æµ‹è¯•Difyå·¥ä½œæµ" ä½¿ç”¨æµ‹è¯•æ–‡æ¡£

### 3. å·¥ä½œæµç¨‹
```
YouTube è§†é¢‘é“¾æ¥ 
     â†“
å°è¯• youtube_transcript_api 
     â†“ (å¤±è´¥)
è‡ªåŠ¨åˆ‡æ¢åˆ° yt-dlp
     â†“ (æˆåŠŸ)
æå–å­—å¹•æ–‡æœ¬
     â†“
è°ƒç”¨ Dify å·¥ä½œæµ
     â†“
ç”Ÿæˆå›¾æ–‡æ–‡ç« 
```

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### yt-dlp ä¼˜åŠ¿
- âœ… **æ›´å¼ºçš„åå°é”èƒ½åŠ›**: ä¸“é—¨å¯¹æŠ— YouTube åçˆ¬è™«
- âœ… **é¢‘ç¹æ›´æ–°**: nightly ç‰ˆæœ¬æ¯æ—¥æ›´æ–°ä¿®å¤
- âœ… **å¤šæ ¼å¼æ”¯æŒ**: æ”¯æŒ srt, vtt, ass ç­‰å­—å¹•æ ¼å¼
- âœ… **æ›´å¥½çš„é”™è¯¯å¤„ç†**: å†…ç½®é‡è¯•å’Œä»£ç†æœºåˆ¶

### å®ç°åŸç†
```python
# åŒé‡ä¿éšœæœºåˆ¶
def extract_youtube_subtitles(video_url, language='en'):
    try:
        # 1. å°è¯• youtube_transcript_api
        return extract_youtube_subtitles_original(video_url, language)
    except Exception:
        # 2. è‡ªåŠ¨åˆ‡æ¢åˆ° yt-dlp
        return extract_youtube_subtitles_ytdlp(video_url, language)
```

## ğŸš¨ æ•…éšœæ’é™¤

### æƒ…å†µ1: ä¸¤ç§æ–¹æ³•éƒ½å¤±è´¥
```bash
# æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬
python update_ytdlp.py
# é€‰æ‹© master ç‰ˆæœ¬ (é€‰é¡¹3)
```

### æƒ…å†µ2: ç½‘ç»œé—®é¢˜
- ä½¿ç”¨ä»£ç†æœåŠ¡å™¨
- ç­‰å¾…ä¸€æ®µæ—¶é—´åé‡è¯•
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

### æƒ…å†µ3: ä¾èµ–é—®é¢˜
```bash
# é‡æ–°å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

## ğŸ“ˆ æˆåŠŸç‡å¯¹æ¯”

| æ–¹æ³• | æˆåŠŸç‡ | æ›´æ–°é¢‘ç‡ | å°é”æ¢å¤æ—¶é—´ |
|-----|-------|---------|------------|
| youtube_transcript_api | ~60% | è¾ƒä½ | æ•°å‘¨ |
| yt-dlp (nightly) | ~90% | æ¯æ—¥ | æ•°å°æ—¶ |
| **åŒé‡ä¿éšœ** | **~95%** | **æ¯æ—¥** | **æ•°å°æ—¶** |

## ğŸ’¡ æœ€ä½³å®è·µ

1. **å®šæœŸæ›´æ–°**: æ¯å‘¨è¿è¡Œ `python update_ytdlp.py`
2. **é€‰æ‹©å¤œé—´ç‰ˆ**: è·å¾—æœ€æ–°çš„åå°é”è¡¥ä¸
3. **ç›‘æ§æ—¥å¿—**: è§‚å¯Ÿå“ªç§æ–¹æ³•æˆåŠŸç‡æ›´é«˜
4. **å¤‡é€‰æ–¹æ¡ˆ**: åœ¨ YouTube å®Œå…¨ä¸å¯ç”¨æ—¶ä½¿ç”¨æµ‹è¯•æ–‡æ¡£

## ğŸ‰ æ€»ç»“

é€šè¿‡ä½¿ç”¨ yt-dlp ä½œä¸ºå¤‡é€‰æ–¹æ¡ˆï¼Œé¡¹ç›®çš„å­—å¹•æå–æˆåŠŸç‡ä» ~60% æå‡åˆ° ~95%ï¼Œå¤§å¤§æé«˜äº†ç³»ç»Ÿçš„å¯é æ€§å’Œç”¨æˆ·ä½“éªŒã€‚ 